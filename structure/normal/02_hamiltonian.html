

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hamiltonian Setup &mdash; EDIpack2.0 2.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=60b53102" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=c2377ec0"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MPI all-2-all transposition" href="02_hamiltonian_common.html" />
    <link rel="prev" title="Hamiltonian Setup" href="../index_hamiltonian.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            EDIpack2.0
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#building">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#id1">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#uninstall">Uninstall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#install-python-api">Install Python API</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/01_anderson.html">Solving a Single Impurity Anderson model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../quickstart/02_dmft.html">Solving Dynamical Mean-Field Theory with <cite>EDIpack2.0</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Further examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/01_bhz.html">Interacting Bernevig-Hughes-Zhang model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/02_ahm.html">Attractive Hubbard model: a superconductive example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/03_excBHZ.html">In-plane excitons in quantum spin Hall insulators</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EDIpack2</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../edipack2.html">EDIpack2.0 Fortran Library</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#library-frontend">Library Frontend</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../edipackmodule.html">EDIpack2 Fortran Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#core-solver-routines">Core Solver Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../main.html">Impurity Problem Solution Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#general-environment">General Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../general/01_ed_input_vars.html">Input Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general/02_ed_vars_global.html">Global Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general/03_ed_aux_funx.html">Auxiliary Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general/04_ed_setup.html">Setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#sparse-matrix">Sparse Matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../classes/01_ed_sparse_matrix.html">Sparse Matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#eigenspace">EigenSpace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../classes/02_ed_eigenspace.html">EigenSpace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#sectors">Sectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../ed_sector.html">Quantum Numbers Sectors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#bath">Bath</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../bath.html">Impurity Model Bath</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../bath.html#bath-auxiliary">Bath Auxiliary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bath.html#bath-dmft">Bath DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../bath.html#bath-functions">Bath Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../../edipack2.html#hamiltonian">Hamiltonian</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index_hamiltonian.html">Hamiltonian Setup</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../index_hamiltonian.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_hamiltonian.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_hamiltonian.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#exact-diagonalization">Exact Diagonalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index_diag.html">Impurity Diagonalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../diag.html">Impurity diagonalization interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_diag.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_diag.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_diag.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#green-s-functions">Green’s Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index_greensfunctions.html">Impurity Green’s functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../greensfunctions.html">Impurity response functions interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_greensfunctions.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_greensfunctions.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_greensfunctions.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#observables">Observables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index_observables.html">Impurity observbales</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../observables.html">Impurity observables interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_observables.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_observables.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_observables.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#reduced-density-matrix">Reduced Density Matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../index_rdm.html">Impurity Reduced Density Matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../rdm.html">Impurity RDM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_rdm.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_rdm.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../index_rdm.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#input-output">Input/Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../io/ed_io.html">Input / Output Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../edipack2.html#chi-2-fit"><span class="math notranslate nohighlight">\(\chi^2\)</span> Fit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../fit.html"><span class="math notranslate nohighlight">\(\chi^2\)</span> Fit</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EDIpy2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../edipy2.html">Python API for EDIpack2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../python_api/pyinstallation.html">EDIpy2 Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python_api/basicusage.html">Basic usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python_api/globvars.html">Global variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.beta"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.beta</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Jh"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Jh</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.dmft_error"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.dmft_error</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.ed_total_ud"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.ed_total_ud</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.ed_twin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.ed_twin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.eps"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.eps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Jx"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Jx</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Jp"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Jp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Lfloat"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lfloat</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Lmats"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lmats</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.LOGfile"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.LOGfile</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Lpos"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lpos</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Lreal"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lreal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Ltau"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Ltau</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Nbath"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nbath</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Nloop"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nloop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Norb"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Norb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Nph"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.nread"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.nread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Nspin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nspin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Nsuccess"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nsuccess</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.sb_field"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.sb_field</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Uloc"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Uloc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.Ust"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Ust</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.wini"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.wini</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.wfin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.wfin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.xmin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.xmin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.xmax"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.xmax</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/globvars.html#edipy2.global_env.xmu"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.xmu</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../python_api/functions.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/funcs/0_readinput.html">Input file manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/0_readinput.html#edipy2.global_env.read_input"><code class="docutils literal notranslate"><span class="pre">read_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/funcs/1_solver.html">Impurity Problem Initialization, Solution and Finalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/1_solver.html#edipy2.global_env.finalize_solver"><code class="docutils literal notranslate"><span class="pre">finalize_solver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/1_solver.html#edipy2.global_env.init_solver"><code class="docutils literal notranslate"><span class="pre">init_solver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/1_solver.html#edipy2.global_env.set_hloc"><code class="docutils literal notranslate"><span class="pre">set_hloc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/1_solver.html#edipy2.global_env.solve"><code class="docutils literal notranslate"><span class="pre">solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/funcs/2_bath.html">Bath Manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.bath_inspect"><code class="docutils literal notranslate"><span class="pre">bath_inspect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.break_symmetry_bath"><code class="docutils literal notranslate"><span class="pre">break_symmetry_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.chi2_fitgf"><code class="docutils literal notranslate"><span class="pre">chi2_fitgf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.get_bath_dimension"><code class="docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.orb_equality_bath"><code class="docutils literal notranslate"><span class="pre">orb_equality_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.orb_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">orb_symmetrize_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.ph_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">ph_symmetrize_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.save_array_as_bath"><code class="docutils literal notranslate"><span class="pre">save_array_as_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.set_hgeneral"><code class="docutils literal notranslate"><span class="pre">set_hgeneral()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.set_hreplica"><code class="docutils literal notranslate"><span class="pre">set_hreplica()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/2_bath.html#edipy2.global_env.spin_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">spin_symmetrize_bath()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html">Input / Output Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_dens"><code class="docutils literal notranslate"><span class="pre">get_dens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_docc"><code class="docutils literal notranslate"><span class="pre">get_docc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_eimp"><code class="docutils literal notranslate"><span class="pre">get_eimp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_mag"><code class="docutils literal notranslate"><span class="pre">get_mag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_phi"><code class="docutils literal notranslate"><span class="pre">get_phi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_gimp"><code class="docutils literal notranslate"><span class="pre">get_gimp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_sigma"><code class="docutils literal notranslate"><span class="pre">get_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_g0and"><code class="docutils literal notranslate"><span class="pre">get_g0and()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_delta"><code class="docutils literal notranslate"><span class="pre">get_delta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_chi"><code class="docutils literal notranslate"><span class="pre">get_chi()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../python_api/funcs/4_auxiliary.html">Auxiliary procedures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/4_auxiliary.html#edipy2.global_env.check_convergence"><code class="docutils literal notranslate"><span class="pre">check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/4_auxiliary.html#edipy2.global_env.get_bath_type"><code class="docutils literal notranslate"><span class="pre">get_bath_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/4_auxiliary.html#edipy2.global_env.get_ed_mode"><code class="docutils literal notranslate"><span class="pre">get_ed_mode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../python_api/funcs/4_auxiliary.html#edipy2.global_env.search_variable"><code class="docutils literal notranslate"><span class="pre">search_variable()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Browse code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../browsecode.html">Browse code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_aux_funx.html">ED_AUX_FUNX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath.html">ED_BATH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath_aux.html">ED_BATH_AUX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath_dim.html">ED_BATH_DIM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath_dmft.html">ED_BATH_DMFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath_fit.html">ED_BATH_FIT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath_functions.html">ED_BATH_FUNCTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath_replica.html">ED_BATH_REPLICA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_bath_user.html">ED_BATH_USER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_chi_dens.html">ED_CHI_DENS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_chi_exct.html">ED_CHI_EXCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_chi_functions.html">ED_CHI_FUNCTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_chi_pair.html">ED_CHI_PAIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_chi_spin.html">ED_CHI_SPIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_diag.html">ED_DIAG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_diag_nonsu2.html">ED_DIAG_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_diag_normal.html">ED_DIAG_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_diag_superc.html">ED_DIAG_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_eigenspace.html">ED_EIGENSPACE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_fit_common.html">ED_FIT_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_fit_general.html">ED_FIT_GENERAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_fit_hybrid.html">ED_FIT_HYBRID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_fit_normal.html">ED_FIT_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_fit_replica.html">ED_FIT_REPLICA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_gf_nonsu2.html">ED_GF_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_gf_normal.html">ED_GF_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_gf_superc.html">ED_GF_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_gfmatrix.html">ED_GFMATRIX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_greens_functions.html">ED_GREENS_FUNCTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian.html">ED_HAMILTONIAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_nonsu2.html">ED_HAMILTONIAN_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_nonsu2_common.html">ED_HAMILTONIAN_NONSU2_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_nonsu2_direct_hxv.html">ED_HAMILTONIAN_NONSU2_DIRECT_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_nonsu2_stored_hxv.html">ED_HAMILTONIAN_NONSU2_STORED_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_normal.html">ED_HAMILTONIAN_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_normal_common.html">ED_HAMILTONIAN_NORMAL_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_normal_direct_hxv.html">ED_HAMILTONIAN_NORMAL_DIRECT_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_normal_stored_hxv.html">ED_HAMILTONIAN_NORMAL_STORED_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_superc.html">ED_HAMILTONIAN_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_superc_common.html">ED_HAMILTONIAN_SUPERC_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_superc_direct_hxv.html">ED_HAMILTONIAN_SUPERC_DIRECT_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_hamiltonian_superc_stored_hxv.html">ED_HAMILTONIAN_SUPERC_STORED_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_input_vars.html">ED_INPUT_VARS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_io.html">ED_IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_main.html">ED_MAIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_observables.html">ED_OBSERVABLES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_observables_nonsu2.html">ED_OBSERVABLES_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_observables_normal.html">ED_OBSERVABLES_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_observables_superc.html">ED_OBSERVABLES_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_rdm.html">ED_RDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_rdm_nonsu2.html">ED_RDM_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_rdm_normal.html">ED_RDM_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_rdm_superc.html">ED_RDM_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_sector.html">ED_SECTOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_setup.html">ED_SETUP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_sparse_map.html">ED_SPARSE_MAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_sparse_matrix.html">ED_SPARSE_MATRIX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_vars_global.html">ED_VARS_GLOBAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/ed_version.html">ED_VERSION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/edi2py_bindings.html">EDI2PY_BINDINGS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../browsesource/module/edipack2.html">EDIPACK2</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/edipack/EDIpack2.0">EDIpack2.0 on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/SciFortran/SciFortran">SciFortran on GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EDIpack2.0</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../edipack2.html">EDIpack2.0 Fortran Library</a></li>
          <li class="breadcrumb-item"><a href="../index_hamiltonian.html">Hamiltonian Setup</a></li>
      <li class="breadcrumb-item active">Hamiltonian Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/structure/normal/02_hamiltonian.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="hamiltonian-setup">
<h1>Hamiltonian Setup<a class="headerlink" href="#hamiltonian-setup" title="Link to this heading"></a></h1>
<p>In <a class="reference internal" href="#f/ed_hamiltonian_normal" title="f/ed_hamiltonian_normal: Setup and build the sector Hamiltonian, returns the correct dimension of the vectors in the Arpack/Lanczos procedure in each thread and provides an interface to Tri-Diagonalize the Hamiltonian on a Krylov basis given a starting vector."><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_hamiltonian_normal</span></code></a> we  setup and build the sector
Hamiltonian, which are then used elsewhere to obtain the low part of
the energy spectrum or construct the dynamical response functions.</p>
<p>The sector electron Hamiltonian is:</p>
<div class="math notranslate nohighlight">
\[H_e = \vec{H}_\downarrow \otimes \vec{1}_\uparrow + \vec{1}_\downarrow \otimes
\vec{H}_\uparrow + H_d + H_{nd}\]</div>
<p>while considering the electron-phonon coupling one has:</p>
<div class="math notranslate nohighlight">
\[H = 1_{ph} \otimes H_e + H_{ph} \otimes 1_e + H_{ph-ph}\otimes H_{e-ph}\]</div>
<p>where <span class="math notranslate nohighlight">\(H_\sigma\)</span> have different shape according to the value of
<a class="reference internal" href="../general/01_ed_input_vars.html#f/ed_input_vars/ed_total_ud" title="f/ed_input_vars/ed_total_ud"><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_total_ud</span></code></a>. See  <a class="reference external" href="https://doi.org/10.1016/j.cpc.2021.108261">j.cpc.2021.108261</a> for further
information about this.</p>
<p>In this operational mode the vectors <span class="math notranslate nohighlight">\(\vec{v}\)</span> are stored as
matrices <span class="math notranslate nohighlight">\(v_{ i_\uparrow i_\downarrow}\)</span>. In parallel mode
anumber of <span class="math notranslate nohighlight">\(Q_\downarrow=\frac{D_\downarrow}{N_{threads}}\)</span> of columns are assigned to each thread.</p>
<p>The matrices <span class="math notranslate nohighlight">\(H_\sigma\)</span>, <span class="math notranslate nohighlight">\(H_d\)</span>, having a small memory footprint, are entirely stored on each thread. The <span class="math notranslate nohighlight">\(H_{nd}\)</span> is
instead splits across the threads and applied using the <code class="code docutils literal notranslate"><span class="pre">allgather_mpi</span></code>  algorithm (see <a class="reference external" href="https://doi.org/10.1016/j.cpc.2021.108261">j.cpc.2021.108261</a> ).</p>
<p>The matrix-vector operation proceeds as follow:
First the diagonal part <span class="math notranslate nohighlight">\(H_d\)</span> is
applied to the vector. This step is local in the memory of each
thread.
The <span class="math notranslate nohighlight">\(H_\uparrow\)</span> is then applied  to  each column of the vector
<span class="math notranslate nohighlight">\(\vec{v}\)</span>. This operation is also local on each thread. Next the matrix <span class="math notranslate nohighlight">\(H_\downarrow\)</span> is applied to the
rows of the vector. In parallel mode this required parallel
transposition of the vector matrix, which allows to perform this step
locally on each thread. Finally, is non-vanishing, the last term
<span class="math notranslate nohighlight">\(H_{nd}\)</span> is applied. In parallel mode, this step requires to
perform a <a class="reference internal" href="../general/03_ed_aux_funx.html#f/ed_aux_funx/allgather_vector_mpi" title="f/ed_aux_funx/allgather_vector_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">allgather_vector_mpi()</span></code></a> which represents the
bottleneck of the parallel execution.</p>
<p class="rubric" id="f/ed_hamiltonian_normal">Description</p>
<p>Setup and build the sector Hamiltonian, returns the correct dimension of the vectors in the Arpack/Lanczos procedure in each thread and provides an interface to Tri-Diagonalize the Hamiltonian on a Krylov basis given a starting vector.</p>
<p class="rubric">Quick access</p>
<dl class="field-list simple">
<dt class="field-odd">Routines<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#f/ed_hamiltonian_normal/build_hv_sector_normal" title="f/ed_hamiltonian_normal/build_hv_sector_normal"><code class="xref f f-func docutils literal notranslate"><span class="pre">build_hv_sector_normal()</span></code></a>, <a class="reference internal" href="#f/ed_hamiltonian_normal/delete_hv_sector_normal" title="f/ed_hamiltonian_normal/delete_hv_sector_normal"><code class="xref f f-func docutils literal notranslate"><span class="pre">delete_hv_sector_normal()</span></code></a>, <a class="reference internal" href="#f/ed_hamiltonian_normal/vecdim_hv_sector_normal" title="f/ed_hamiltonian_normal/vecdim_hv_sector_normal"><code class="xref f f-func docutils literal notranslate"><span class="pre">vecdim_hv_sector_normal()</span></code></a>, <a class="reference internal" href="#f/ed_hamiltonian_normal/tridiag_hv_sector_normal" title="f/ed_hamiltonian_normal/tridiag_hv_sector_normal"><code class="xref f f-func docutils literal notranslate"><span class="pre">tridiag_hv_sector_normal()</span></code></a></p>
</dd>
</dl>
<p class="rubric">Used modules</p>
<ul class="simple">
<li><p><a class="reference internal" href="02_hamiltonian_common.html#f/ed_hamiltonian_normal_common" title="f/ed_hamiltonian_normal_common: Global variables related to sector Hamiltonian construction. It  contains the :f:func:`vector_transpose_mpi` implementing the  MPI :code:`Allv-2-Allv` parallel matrix transposition."><code class="xref f f-mod docutils literal notranslate"><span class="pre">ed_hamiltonian_normal_common</span></code></a>: Global variables related to sector Hamiltonian construction. It  contains the <a class="reference internal" href="02_hamiltonian_common.html#f/ed_hamiltonian_normal_common/vector_transpose_mpi" title="f/ed_hamiltonian_normal_common/vector_transpose_mpi"><code class="xref f f-func docutils literal notranslate"><span class="pre">vector_transpose_mpi()</span></code></a> implementing the  MPI <code class="code docutils literal notranslate"><span class="pre">Allv-2-Allv</span></code> parallel matrix transposition.</p></li>
<li><p><a class="reference internal" href="02_hamiltonian_sparse.html#f/ed_hamiltonian_normal_stored_hxv" title="f/ed_hamiltonian_normal_stored_hxv: Constructs each terms of the sector Hamiltonian storing them into different :f:var:`sparse_matrix` instances, implement the corresponding matrix-vector products using stored sparse matrices."><code class="xref f f-mod docutils literal notranslate"><span class="pre">ed_hamiltonian_normal_stored_hxv</span></code></a>: Constructs each terms of the sector Hamiltonian storing them into different <code class="xref f f-var docutils literal notranslate"><span class="pre">sparse_matrix</span></code> instances, implement the corresponding matrix-vector products using stored sparse matrices.</p></li>
<li><p><a class="reference internal" href="02_hamiltonian_direct.html#f/ed_hamiltonian_normal_direct_hxv" title="f/ed_hamiltonian_normal_direct_hxv: Constructs and applies on-the-fly each term of the sector Hamiltonian to the input vector :math:`\vec{w} = H\times \vec{v}` in a Arpack/Lanczos framework."><code class="xref f f-mod docutils literal notranslate"><span class="pre">ed_hamiltonian_normal_direct_hxv</span></code></a>: Constructs and applies on-the-fly each term of the sector Hamiltonian to the input vector <span class="math notranslate nohighlight">\(\vec{w} = H\times \vec{v}\)</span> in a Arpack/Lanczos framework.</p></li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl>
<dt class="sig sig-object f" id="f/ed_hamiltonian_normal/build_hv_sector_normal">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">ed_hamiltonian_normal/</span></span><span class="sig-name descname"><span class="pre">build_hv_sector_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">isector</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">hmat</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f/ed_hamiltonian_normal/build_hv_sector_normal" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Builds the matrix-vector product <span class="math notranslate nohighlight">\(H\times \vec{v}\)</span> in the current sector.</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Building the sector through <a class="reference internal" href="../ed_sector.html#f/ed_sector/build_sector" title="f/ed_sector/build_sector"><code class="xref f f-func docutils literal notranslate"><span class="pre">build_sector()</span></code></a> for <code class="xref f f-var docutils literal notranslate"><span class="pre">isector</span></code></p></li>
<li><p>Retrieve all dimensions of the sectors, setup the MPI split in parallel mode.</p></li>
<li><p>If total sector dimension is &lt; <a class="reference internal" href="../general/01_ed_input_vars.html#f/ed_input_vars/lanc_dim_threshold" title="f/ed_input_vars/lanc_dim_threshold"><code class="xref f f-var docutils literal notranslate"><span class="pre">lanc_dim_threshold</span></code></a> then Hamiltonian is stored into dense matrix for Lapack diagonalization</p></li>
<li><p>Else we proceeds according to the followins scheme:</p></li>
</ol>
</div></blockquote>
</div></blockquote>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Build Hamiltonian, <span class="math notranslate nohighlight">\(H\times\vec{v}\)</span> products.</span><a class="headerlink" href="#id1" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head stub"></th>
<th class="head"><p><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_sparse_H</span></code> = <code class="code docutils literal notranslate"><span class="pre">T</span></code></p></th>
<th class="head"><p><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_sparse_H</span></code> = <code class="code docutils literal notranslate"><span class="pre">F</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><th class="stub"><p><a class="reference internal" href="../general/01_ed_input_vars.html#f/ed_input_vars/ed_total_ud" title="f/ed_input_vars/ed_total_ud"><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_total_ud</span></code></a> = <code class="code docutils literal notranslate"><span class="pre">T</span></code></p></th>
<td><div class="line-block">
<div class="line">call <a class="reference internal" href="02_hamiltonian_sparse.html#f/ed_hamiltonian_normal_stored_hxv/ed_buildh_normal_main" title="f/ed_hamiltonian_normal_stored_hxv/ed_buildh_normal_main"><code class="xref f f-func docutils literal notranslate"><span class="pre">ed_buildh_normal_main()</span></code></a></div>
<div class="line">serial: <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_sparse.html#f/ed_hamiltonian_normal_stored_hxv/spmatvec_normal_main" title="f/ed_hamiltonian_normal_stored_hxv/spmatvec_normal_main"><code class="xref f f-func docutils literal notranslate"><span class="pre">spmatvec_normal_main()</span></code></a></div>
<div class="line">MPI:    <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_sparse.html#f/ed_hamiltonian_normal_stored_hxv/spmatvec_mpi_normal_main" title="f/ed_hamiltonian_normal_stored_hxv/spmatvec_mpi_normal_main"><code class="xref f f-func docutils literal notranslate"><span class="pre">spmatvec_mpi_normal_main()</span></code></a></div>
</div>
</td>
<td><div class="line-block">
<div class="line">serial: <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_direct.html#f/ed_hamiltonian_normal_direct_hxv/directmatvec_normal_main" title="f/ed_hamiltonian_normal_direct_hxv/directmatvec_normal_main"><code class="xref f f-func docutils literal notranslate"><span class="pre">directmatvec_normal_main()</span></code></a></div>
<div class="line">MPI:    <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_direct.html#f/ed_hamiltonian_normal_direct_hxv/directmatvec_mpi_normal_main" title="f/ed_hamiltonian_normal_direct_hxv/directmatvec_mpi_normal_main"><code class="xref f f-func docutils literal notranslate"><span class="pre">directmatvec_mpi_normal_main()</span></code></a></div>
</div>
</td>
</tr>
<tr class="row-odd"><th class="stub"><p><a class="reference internal" href="../general/01_ed_input_vars.html#f/ed_input_vars/ed_total_ud" title="f/ed_input_vars/ed_total_ud"><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_total_ud</span></code></a> = <code class="code docutils literal notranslate"><span class="pre">F</span></code></p></th>
<td><div class="line-block">
<div class="line">call <a class="reference internal" href="02_hamiltonian_sparse.html#f/ed_hamiltonian_normal_stored_hxv/ed_buildh_normal_orbs" title="f/ed_hamiltonian_normal_stored_hxv/ed_buildh_normal_orbs"><code class="xref f f-func docutils literal notranslate"><span class="pre">ed_buildh_normal_orbs()</span></code></a></div>
<div class="line">serial: <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_sparse.html#f/ed_hamiltonian_normal_stored_hxv/spmatvec_normal_orbs" title="f/ed_hamiltonian_normal_stored_hxv/spmatvec_normal_orbs"><code class="xref f f-func docutils literal notranslate"><span class="pre">spmatvec_normal_orbs()</span></code></a></div>
<div class="line">MPI:    <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_sparse.html#f/ed_hamiltonian_normal_stored_hxv/spmatvec_mpi_normal_orbs" title="f/ed_hamiltonian_normal_stored_hxv/spmatvec_mpi_normal_orbs"><code class="xref f f-func docutils literal notranslate"><span class="pre">spmatvec_mpi_normal_orbs()</span></code></a></div>
</div>
</td>
<td><div class="line-block">
<div class="line">serial: <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_direct.html#f/ed_hamiltonian_normal_direct_hxv/directmatvec_normal_orbs" title="f/ed_hamiltonian_normal_direct_hxv/directmatvec_normal_orbs"><code class="xref f f-func docutils literal notranslate"><span class="pre">directmatvec_normal_orbs()</span></code></a></div>
<div class="line">MPI:    <code class="xref f f-func docutils literal notranslate"><span class="pre">sphtimesv_p()</span></code> <code class="code docutils literal notranslate"><span class="pre">=&gt;</span></code> <a class="reference internal" href="02_hamiltonian_direct.html#f/ed_hamiltonian_normal_direct_hxv/directmatvec_mpi_normal_orbs" title="f/ed_hamiltonian_normal_direct_hxv/directmatvec_mpi_normal_orbs"><code class="xref f f-func docutils literal notranslate"><span class="pre">directmatvec_mpi_normal_orbs()</span></code></a></div>
</div>
</td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>isector</strong><em> [</em><em>integer</em><em>]</em> – Index of the actual sector to be analyzed</p>
</dd>
<dt class="field-even">Options<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hmat</strong> (•, •)<em> [</em><em>real</em><em>]</em> – Dense matrix to store the sector Hamiltonian is dim &lt; <a class="reference internal" href="../general/01_ed_input_vars.html#f/ed_input_vars/lanc_dim_threshold" title="f/ed_input_vars/lanc_dim_threshold"><code class="xref f f-var docutils literal notranslate"><span class="pre">lanc_dim_threshold</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/ed_hamiltonian_normal/delete_hv_sector_normal">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">ed_hamiltonian_normal/</span></span><span class="sig-name descname"><span class="pre">delete_hv_sector_normal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/ed_hamiltonian_normal/delete_hv_sector_normal" title="Link to this definition"></a></dt>
<dd><p>Delete the all the memory used to construct the sector Hamiltonian and the corresponding matrix vector products.
The sector is deleted, all the dimensions and MPI splitting variables are reset to zero. All the sparse matrices are deallocated having gone out of scope. The abstract interface pointer <code class="xref f f-var docutils literal notranslate"><span class="pre">spHtimesV_p</span></code> for the matrix-vector product is nullified.</p>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/ed_hamiltonian_normal/vecdim_hv_sector_normal">
<em class="property"><span class="pre">function</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">ed_hamiltonian_normal/</span></span><span class="sig-name descname"><span class="pre">vecdim_hv_sector_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">isector</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/ed_hamiltonian_normal/vecdim_hv_sector_normal" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Returns the dimensions <code class="xref f f-var docutils literal notranslate"><span class="pre">vecdim</span></code> of the vectors used in the Arpack/Lanczos produces given the current sector index <code class="xref f f-var docutils literal notranslate"><span class="pre">isector</span></code> . If parallel mode is active the returned dimension corresponds to the correct chunk for each thread.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>isector</strong><em> [</em><em>integer</em><em>]</em> – current sector index</p>
</dd>
<dt class="field-even">Return<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vecdim</strong><em> [</em><em>integer</em><em>]</em> – vector or vector chunck dimension</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt class="sig sig-object f" id="f/ed_hamiltonian_normal/tridiag_hv_sector_normal">
<em class="property"><span class="pre">subroutine</span>&#160; </em><span class="sig-prename descclassname"><span class="pre">ed_hamiltonian_normal/</span></span><span class="sig-name descname"><span class="pre">tridiag_hv_sector_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">isector</span></em>, <em class="sig-param"><span class="pre">vvinit</span></em>, <em class="sig-param"><span class="pre">alanc</span></em>, <em class="sig-param"><span class="pre">blanc</span></em>, <em class="sig-param"><span class="pre">norm2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#f/ed_hamiltonian_normal/tridiag_hv_sector_normal" title="Link to this definition"></a></dt>
<dd><blockquote>
<div><p>Returns the parameters <span class="math notranslate nohighlight">\(\vec{\alpha}\)</span> and <span class="math notranslate nohighlight">\(\vec{\beta}\)</span> , respectively <code class="xref f f-var docutils literal notranslate"><span class="pre">alanc</span></code> and <code class="xref f f-var docutils literal notranslate"><span class="pre">blanc</span></code> , of the partial tridiagonalization of the sector Hamiltonian on a Krylov basis with starting vector <code class="xref f f-var docutils literal notranslate"><span class="pre">vvinit</span></code>.</p>
<dl class="simple">
<dt>Input:</dt><dd><ul class="simple">
<li><p><code class="xref f f-var docutils literal notranslate"><span class="pre">isector</span></code></p></li>
<li><p><code class="xref f f-var docutils literal notranslate"><span class="pre">vvinit</span></code></p></li>
</ul>
</dd>
<dt>Output:</dt><dd><ul class="simple">
<li><p><code class="xref f f-var docutils literal notranslate"><span class="pre">alanc</span></code> corresponding to <span class="math notranslate nohighlight">\(\vec{\alpha}\)</span></p></li>
<li><p><code class="xref f f-var docutils literal notranslate"><span class="pre">blanc</span></code> corresponding to <span class="math notranslate nohighlight">\(\vec{\beta}\)</span></p></li>
<li><p><code class="xref f f-var docutils literal notranslate"><span class="pre">norm2</span></code> the norm of the input vector  <span class="math notranslate nohighlight">\(\langle {\rm vvinit}|{\rm vvinit}\rangle\)</span></p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>isector</strong><em> [</em><em>integer</em><em>]</em> – current sector index</p></li>
<li><p><strong>vvinit</strong> (•)<em> [</em><em>real</em><em>]</em> – input vector for the construction of the tridiagonal or Krylov basis</p></li>
<li><p><strong>alanc</strong> (•)<em> [</em><em>real</em><em>, </em><em>allocatable</em><em>]</em> – <span class="math notranslate nohighlight">\(\vec{\alpha}\)</span> or diagonal parameters of the tridiagonal basis.</p></li>
<li><p><strong>blanc</strong> (•)<em> [</em><em>real</em><em>, </em><em>allocatable</em><em>]</em> – <span class="math notranslate nohighlight">\(\vec{\beta}\)</span> or sub-/over-diagonal parameters of the tridiagonal basis.</p></li>
<li><p><strong>norm2</strong><em> [</em><em>real</em><em>]</em> – norm of the input vector <code class="xref f f-var docutils literal notranslate"><span class="pre">vvinit</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index_hamiltonian.html" class="btn btn-neutral float-left" title="Hamiltonian Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="02_hamiltonian_common.html" class="btn btn-neutral float-right" title="MPI all-2-all transposition" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Lorenzo Crippa and Adriano Amaricci.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Attractive Hubbard model: a superconductive example &mdash; EDIpack2.0 2.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=60b53102" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=c2377ec0"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="In-plane excitons in quantum spin Hall insulators" href="03_excBHZ.html" />
    <link rel="prev" title="Interacting Bernevig-Hughes-Zhang model" href="01_bhz.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            EDIpack2.0
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#building">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#id1">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#uninstall">Uninstall</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#install-python-api">Install Python API</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/01_anderson.html">Solving a Single Impurity Anderson model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart/02_dmft.html">Solving Dynamical Mean-Field Theory with <cite>EDIpack2.0</cite></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Further examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_bhz.html">Interacting Bernevig-Hughes-Zhang model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Attractive Hubbard model: a superconductive example</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_excBHZ.html">In-plane excitons in quantum spin Hall insulators</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EDIpack2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../edipack2.html">EDIpack2.0 Fortran Library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#library-frontend">Library Frontend</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/edipackmodule.html">EDIpack2 Fortran Module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#core-solver-routines">Core Solver Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/main.html">Impurity Problem Solution Routines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#general-environment">General Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/general/01_ed_input_vars.html">Input Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structure/general/02_ed_vars_global.html">Global Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structure/general/03_ed_aux_funx.html">Auxiliary Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../structure/general/04_ed_setup.html">Setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#sparse-matrix">Sparse Matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/classes/01_ed_sparse_matrix.html">Sparse Matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#eigenspace">EigenSpace</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/classes/02_ed_eigenspace.html">EigenSpace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#sectors">Sectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/ed_sector.html">Quantum Numbers Sectors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#bath">Bath</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/bath.html">Impurity Model Bath</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../structure/bath.html#bath-auxiliary">Bath Auxiliary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/bath.html#bath-dmft">Bath DMFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/bath.html#bath-functions">Bath Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#hamiltonian">Hamiltonian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/index_hamiltonian.html">Hamiltonian Setup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_hamiltonian.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_hamiltonian.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_hamiltonian.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#exact-diagonalization">Exact Diagonalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/index_diag.html">Impurity Diagonalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../structure/diag.html">Impurity diagonalization interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_diag.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_diag.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_diag.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#green-s-functions">Green’s Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/index_greensfunctions.html">Impurity Green’s functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../structure/greensfunctions.html">Impurity response functions interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_greensfunctions.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_greensfunctions.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_greensfunctions.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#observables">Observables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/index_observables.html">Impurity observbales</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../structure/observables.html">Impurity observables interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_observables.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_observables.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_observables.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#reduced-density-matrix">Reduced Density Matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/index_rdm.html">Impurity Reduced Density Matrix</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../structure/rdm.html">Impurity RDM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_rdm.html#normal-mode">Normal mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_rdm.html#superconductive-mode">Superconductive mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="../structure/index_rdm.html#non-su-2-mode">Non-SU(2) mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#input-output">Input/Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/io/ed_io.html">Input / Output Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../edipack2.html#chi-2-fit"><span class="math notranslate nohighlight">\(\chi^2\)</span> Fit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../structure/fit.html"><span class="math notranslate nohighlight">\(\chi^2\)</span> Fit</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EDIpy2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../edipy2.html">Python API for EDIpack2</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../python_api/pyinstallation.html">EDIpy2 Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/basicusage.html">Basic usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/globvars.html">Global variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.beta"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.beta</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Jh"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Jh</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.dmft_error"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.dmft_error</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.ed_total_ud"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.ed_total_ud</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.ed_twin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.ed_twin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.eps"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.eps</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Jx"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Jx</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Jp"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Jp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Lfloat"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lfloat</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Lmats"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lmats</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.LOGfile"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.LOGfile</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Lpos"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lpos</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Lreal"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Lreal</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Ltau"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Ltau</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Nbath"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nbath</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Nloop"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nloop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Norb"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Norb</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Nph"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nph</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.nread"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.nread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Nspin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nspin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Nsuccess"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Nsuccess</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.sb_field"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.sb_field</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Uloc"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Uloc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.Ust"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.Ust</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.wini"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.wini</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.wfin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.wfin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.xmin"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.xmin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.xmax"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.xmax</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/globvars.html#edipy2.global_env.xmu"><code class="docutils literal notranslate"><span class="pre">edipy2.global_env.xmu</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../python_api/functions.html">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../python_api/funcs/0_readinput.html">Input file manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/0_readinput.html#edipy2.global_env.read_input"><code class="docutils literal notranslate"><span class="pre">read_input()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/funcs/1_solver.html">Impurity Problem Initialization, Solution and Finalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/1_solver.html#edipy2.global_env.finalize_solver"><code class="docutils literal notranslate"><span class="pre">finalize_solver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/1_solver.html#edipy2.global_env.init_solver"><code class="docutils literal notranslate"><span class="pre">init_solver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/1_solver.html#edipy2.global_env.set_hloc"><code class="docutils literal notranslate"><span class="pre">set_hloc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/1_solver.html#edipy2.global_env.solve"><code class="docutils literal notranslate"><span class="pre">solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/funcs/2_bath.html">Bath Manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.bath_inspect"><code class="docutils literal notranslate"><span class="pre">bath_inspect()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.break_symmetry_bath"><code class="docutils literal notranslate"><span class="pre">break_symmetry_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.chi2_fitgf"><code class="docutils literal notranslate"><span class="pre">chi2_fitgf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.get_bath_dimension"><code class="docutils literal notranslate"><span class="pre">get_bath_dimension()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.orb_equality_bath"><code class="docutils literal notranslate"><span class="pre">orb_equality_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.orb_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">orb_symmetrize_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.ph_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">ph_symmetrize_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.save_array_as_bath"><code class="docutils literal notranslate"><span class="pre">save_array_as_bath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.set_hgeneral"><code class="docutils literal notranslate"><span class="pre">set_hgeneral()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.set_hreplica"><code class="docutils literal notranslate"><span class="pre">set_hreplica()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/2_bath.html#edipy2.global_env.spin_symmetrize_bath"><code class="docutils literal notranslate"><span class="pre">spin_symmetrize_bath()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html">Input / Output Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_dens"><code class="docutils literal notranslate"><span class="pre">get_dens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_docc"><code class="docutils literal notranslate"><span class="pre">get_docc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_eimp"><code class="docutils literal notranslate"><span class="pre">get_eimp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_mag"><code class="docutils literal notranslate"><span class="pre">get_mag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_phi"><code class="docutils literal notranslate"><span class="pre">get_phi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_gimp"><code class="docutils literal notranslate"><span class="pre">get_gimp()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_sigma"><code class="docutils literal notranslate"><span class="pre">get_sigma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_g0and"><code class="docutils literal notranslate"><span class="pre">get_g0and()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_delta"><code class="docutils literal notranslate"><span class="pre">get_delta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/3_inputoutput.html#edipy2.global_env.get_chi"><code class="docutils literal notranslate"><span class="pre">get_chi()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../python_api/funcs/4_auxiliary.html">Auxiliary procedures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/4_auxiliary.html#edipy2.global_env.check_convergence"><code class="docutils literal notranslate"><span class="pre">check_convergence()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/4_auxiliary.html#edipy2.global_env.get_bath_type"><code class="docutils literal notranslate"><span class="pre">get_bath_type()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/4_auxiliary.html#edipy2.global_env.get_ed_mode"><code class="docutils literal notranslate"><span class="pre">get_ed_mode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../python_api/funcs/4_auxiliary.html#edipy2.global_env.search_variable"><code class="docutils literal notranslate"><span class="pre">search_variable()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Browse code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../browsecode.html">Browse code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_aux_funx.html">ED_AUX_FUNX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath.html">ED_BATH</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath_aux.html">ED_BATH_AUX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath_dim.html">ED_BATH_DIM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath_dmft.html">ED_BATH_DMFT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath_fit.html">ED_BATH_FIT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath_functions.html">ED_BATH_FUNCTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath_replica.html">ED_BATH_REPLICA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_bath_user.html">ED_BATH_USER</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_chi_dens.html">ED_CHI_DENS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_chi_exct.html">ED_CHI_EXCT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_chi_functions.html">ED_CHI_FUNCTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_chi_pair.html">ED_CHI_PAIR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_chi_spin.html">ED_CHI_SPIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_diag.html">ED_DIAG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_diag_nonsu2.html">ED_DIAG_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_diag_normal.html">ED_DIAG_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_diag_superc.html">ED_DIAG_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_eigenspace.html">ED_EIGENSPACE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_fit_common.html">ED_FIT_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_fit_general.html">ED_FIT_GENERAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_fit_hybrid.html">ED_FIT_HYBRID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_fit_normal.html">ED_FIT_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_fit_replica.html">ED_FIT_REPLICA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_gf_nonsu2.html">ED_GF_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_gf_normal.html">ED_GF_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_gf_superc.html">ED_GF_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_gfmatrix.html">ED_GFMATRIX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_greens_functions.html">ED_GREENS_FUNCTIONS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian.html">ED_HAMILTONIAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_nonsu2.html">ED_HAMILTONIAN_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_nonsu2_common.html">ED_HAMILTONIAN_NONSU2_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_nonsu2_direct_hxv.html">ED_HAMILTONIAN_NONSU2_DIRECT_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_nonsu2_stored_hxv.html">ED_HAMILTONIAN_NONSU2_STORED_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_normal.html">ED_HAMILTONIAN_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_normal_common.html">ED_HAMILTONIAN_NORMAL_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_normal_direct_hxv.html">ED_HAMILTONIAN_NORMAL_DIRECT_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_normal_stored_hxv.html">ED_HAMILTONIAN_NORMAL_STORED_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_superc.html">ED_HAMILTONIAN_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_superc_common.html">ED_HAMILTONIAN_SUPERC_COMMON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_superc_direct_hxv.html">ED_HAMILTONIAN_SUPERC_DIRECT_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_hamiltonian_superc_stored_hxv.html">ED_HAMILTONIAN_SUPERC_STORED_HxV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_input_vars.html">ED_INPUT_VARS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_io.html">ED_IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_main.html">ED_MAIN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_observables.html">ED_OBSERVABLES</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_observables_nonsu2.html">ED_OBSERVABLES_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_observables_normal.html">ED_OBSERVABLES_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_observables_superc.html">ED_OBSERVABLES_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_rdm.html">ED_RDM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_rdm_nonsu2.html">ED_RDM_NONSU2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_rdm_normal.html">ED_RDM_NORMAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_rdm_superc.html">ED_RDM_SUPERC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_sector.html">ED_SECTOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_setup.html">ED_SETUP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_sparse_map.html">ED_SPARSE_MAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_sparse_matrix.html">ED_SPARSE_MATRIX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_vars_global.html">ED_VARS_GLOBAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/ed_version.html">ED_VERSION</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/edi2py_bindings.html">EDI2PY_BINDINGS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../browsesource/module/edipack2.html">EDIPACK2</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/edipack/EDIpack2.0">EDIpack2.0 on GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/SciFortran/SciFortran">SciFortran on GitHub</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">EDIpack2.0</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../examples.html">Further examples</a></li>
      <li class="breadcrumb-item active">Attractive Hubbard model: a superconductive example</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/02_ahm.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="attractive-hubbard-model-a-superconductive-example">
<h1>Attractive Hubbard model: a superconductive example<a class="headerlink" href="#attractive-hubbard-model-a-superconductive-example" title="Link to this heading"></a></h1>
<p>In this second example we focus on the use of <cite>EDIpack2.0</cite> ED method
as a solver for DMFT in presence of superconductivity, i.e. <a class="reference internal" href="../structure/general/01_ed_input_vars.html#f/ed_input_vars/ed_mode" title="f/ed_input_vars/ed_mode"><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_mode</span></code></a> = <strong>superc</strong>.</p>
<p>We consider the simple, but non-trivial, case of the attractive
single-band Fermi-Hubbard model on a square lattice:</p>
<div class="math notranslate nohighlight">
\[H  = \sum_{k\sigma} \epsilon(k) c^\dagger_{k\sigma}c_{k\sigma} -
|U| \sum_i n_{i\uparrow}n_{i\downarrow}\]</div>
<p>Similarly to the previous case, the preamble of the code contains
definition of  the required local variables. We load all the required
modules, including  <a class="reference external" href="https://github.com/aamaricci/DMFTtools">DMFT_TOOLS</a> library to perform some tasks
related to DMFT implementation. We read the input file using
<a class="reference internal" href="../structure/general/01_ed_input_vars.html#f/ed_input_vars/ed_read_input" title="f/ed_input_vars/ed_read_input"><code class="xref f f-func docutils literal notranslate"><span class="pre">ed_read_input()</span></code></a>. Given the simplicity of this program we do
<strong>not</strong> make use of MPI setup here. In the absence of MPI
initialization, the <cite>EDIpack2.0</cite> code will automatically fall back to
serial execution.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">ed_ahm_2d</span>
<span class="w">   </span><span class="k">USE </span><span class="n">EDIPACK2</span>
<span class="w">   </span><span class="k">USE </span><span class="n">SCIFOR</span>
<span class="w">   </span><span class="k">USE </span><span class="n">DMFT_TOOLS</span>
<span class="w">   </span><span class="k">implicit none</span>
<span class="w">   </span><span class="c">!&gt; a list of the variable used in this code</span>

<span class="w">   </span><span class="p">...</span>

<span class="w">   </span><span class="c">!&gt; Parse some variables</span>
<span class="w">   </span><span class="k">call </span><span class="n">parse_cmd_variable</span><span class="p">(</span><span class="n">finput</span><span class="p">,</span><span class="s2">&quot;FINPUT&quot;</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="s1">&#39;inputAHM.conf&#39;</span><span class="p">)</span>
<span class="w">   </span><span class="k">call </span><span class="n">parse_input_variable</span><span class="p">(</span><span class="n">wmixing</span><span class="p">,</span><span class="s2">&quot;wmixing&quot;</span><span class="p">,</span><span class="n">finput</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="mf">0.5d0</span><span class="p">,</span><span class="n">comment</span><span class="o">=</span><span class="s2">&quot;Mixing bath parameter&quot;</span><span class="p">)</span>

<span class="w">   </span><span class="c">!&gt; read ED input</span>
<span class="w">   </span><span class="k">call </span><span class="n">ed_read_input</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">finput</span><span class="p">))</span>
</pre></div>
</div>
<p>We deal with superconducting case using Nambu structure of the local
functions and Hamiltonians, for instance the Green’s function has the matrix form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
\hat{G}_{\uparrow\uparrow} &amp; \hat{F}_{\uparrow\downarrow}\\
\bar{\hat{F}}_{\downarrow\uparrow}  &amp;    \bar{\hat{G}}_{\downarrow\downarrow} \\
\end{pmatrix}\end{split}\]</div>
<p>where the <span class="math notranslate nohighlight">\(\hat{A}\)</span> indicates the multi-orbital character of the
function, while the <span class="math notranslate nohighlight">\(\bar{A}\)</span> symbol indicates the components related to the first row ones
by particle-hole and time-reversal symmetry. The actual implementation
of such symmetries depends on the argument of the functions, i.e. Matsubara or
Real-axis. Exploiting the relation among components, we need to keep track only of
the first row elements. To this end, we consider a further leading
dimension of size 2 for all local functions and Hamiltonian.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!&gt; Allocate local functions. The leading dimension indicates the Nambu 11,12 components.</span>
<span class="c">!    We get the other components by symmetry.</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Gmats</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Lmats</span><span class="p">))</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Smats</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Lmats</span><span class="p">))</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Weiss</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Lmats</span><span class="p">))</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Greal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Lreal</span><span class="p">))</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Sreal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Nso</span><span class="p">,</span><span class="n">Lreal</span><span class="p">))</span>
</pre></div>
</div>
<p>Next we construct the dispersion and the exact DOS of the 2d square
lattice using <cite>SciFortran</cite> functions. Note again the leading dimension
2 of the dispersion.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!&gt; Build the 2d square lattice exact DOS and dispersion for the Nambu structure (use DMFT_TOOLS)</span>
<span class="c">!    We ask for separate dispersions, or two H(k), for the two diagonal Nambu components 11,22</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Edos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">Le</span><span class="p">))</span><span class="w">  </span><span class="c">![Nambu 11,12, Number of orbitals, Number of energy levels]</span>
<span class="n">Edos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Le</span><span class="p">,</span><span class="n">mesh</span><span class="o">=</span><span class="n">de</span><span class="p">)</span>
<span class="n">Edos</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,:)</span><span class="w"> </span><span class="o">=-</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">D</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">Le</span><span class="p">,</span><span class="n">mesh</span><span class="o">=</span><span class="n">de</span><span class="p">)</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Ddos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Le</span><span class="p">))</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Le</span>
<span class="w">  </span><span class="n">Ddos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dens_2dsquare</span><span class="p">(</span><span class="n">Edos</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">),</span><span class="n">D</span><span class="p">)</span><span class="o">*</span><span class="n">de</span>
<span class="k">enddo</span>
<span class="c">!&gt; Get local Hamiltonian (to be used in DMFT_TOOLS)</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">H0</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">H0</span><span class="o">=</span><span class="mi">0</span><span class="n">d0</span>
</pre></div>
</div>
<p>We start the DMFT calculation by query the bath dimension (which
include superconductive parameters) and allocating the  bath on the
user side. Finally we initialize the ED solver.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!&gt; Get bath dimension and allocate user bath to this size</span>
<span class="n">Nb</span><span class="o">=</span><span class="n">ed_get_bath_dimension</span><span class="p">()</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Bath</span><span class="p">(</span><span class="n">Nb</span><span class="p">))</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">Bath_prev</span><span class="p">(</span><span class="n">Nb</span><span class="p">))</span>

<span class="c">!&gt; Initialize the ED solver (bath is guessed or read from file)</span>
<span class="k">call </span><span class="n">ed_init_solver</span><span class="p">(</span><span class="n">bath</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we implement the DMFT loop, using a similar structure as we
discussed in the previous sections:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Solve the quantum impurity problem for a given user bath
<span class="math notranslate nohighlight">\(\vec{b}\)</span>, which with <a class="reference internal" href="../structure/general/01_ed_input_vars.html#f/ed_input_vars/ed_mode" title="f/ed_input_vars/ed_mode"><code class="xref f f-var docutils literal notranslate"><span class="pre">ed_mode</span></code></a> = <strong>superc</strong> includes the bath pair amplitudes.</p></li>
<li><p>Retrieve Matsubara self-energies <span class="math notranslate nohighlight">\(\Sigma\)</span> and <span class="math notranslate nohighlight">\(S\)</span>,
get the local Nambu Green’s function
<span class="math notranslate nohighlight">\(\hat{G}_{loc}=\int d\epsilon [i\omega_n + \mu - \hat{\epsilon} - \hat{\Sigma}(i\omega_n)]^{-1}\)</span> where the <span class="math notranslate nohighlight">\(\hat{A}\)</span> indicates the multi-orbital and the Nambu structure.</p></li>
<li><p>Implement DMFT self-consistency to update Nambu Weiss fields:
<span class="math notranslate nohighlight">\(\hat{{\cal G}}_0 = [\hat{G}^{-1}_{loc} + \hat{\Sigma}]^{-1}\)</span></p></li>
<li><p>Update the user bath <span class="math notranslate nohighlight">\(\vec{b}\)</span> using <span class="math notranslate nohighlight">\(\chi^2\)</span>
optimization against the obtained updated Nambu Weiss fields.</p></li>
<li><p>Check error and restart.</p></li>
</ol>
</div></blockquote>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!DMFT loop</span>
<span class="n">iloop</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">converged</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span>
<span class="k">do while</span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">converged</span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="n">iloop</span><span class="o">&lt;</span><span class="n">nloop</span><span class="p">)</span>
<span class="w">  </span><span class="n">iloop</span><span class="o">=</span><span class="n">iloop</span><span class="o">+</span><span class="mi">1</span>

<span class="w">  </span><span class="c">!&gt; Solve the impurity problem, retrieve matsubara self-energy</span>
<span class="w">  </span><span class="k">call </span><span class="n">ed_solve</span><span class="p">(</span><span class="n">bath</span><span class="p">)</span>

<span class="w">  </span><span class="c">!&gt; Retrieve impurity self-energies (normal, anomalous)</span>
<span class="w">  </span><span class="k">call </span><span class="n">ed_get_sigma</span><span class="p">(</span><span class="n">Smats</span><span class="p">(</span><span class="mi">1</span><span class="p">,:,:,:),</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="w">  </span><span class="k">call </span><span class="n">ed_get_sigma</span><span class="p">(</span><span class="n">Smats</span><span class="p">(</span><span class="mi">2</span><span class="p">,:,:,:),</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>

<span class="w">  </span><span class="c">!&gt; Get Gloc (using DMFT_TOOLS)</span>
<span class="w">  </span><span class="k">call </span><span class="n">get_gloc</span><span class="p">(</span><span class="n">Edos</span><span class="p">,</span><span class="n">Ddos</span><span class="p">,</span><span class="n">H0</span><span class="p">,</span><span class="n">Gmats</span><span class="p">,</span><span class="n">Smats</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>

<span class="w">  </span><span class="c">!&gt; Update the Weiss field: (using DMFT_TOOLS).</span>
<span class="w">  </span><span class="k">call </span><span class="n">dmft_self_consistency</span><span class="p">(&amp;</span>
<span class="w">       </span><span class="n">Gmats</span><span class="p">(</span><span class="mi">1</span><span class="p">,:,:,:),</span><span class="n">Gmats</span><span class="p">(</span><span class="mi">2</span><span class="p">,:,:,:),&amp;</span>
<span class="w">       </span><span class="n">Smats</span><span class="p">(</span><span class="mi">1</span><span class="p">,:,:,:),</span><span class="n">Smats</span><span class="p">(</span><span class="mi">2</span><span class="p">,:,:,:),&amp;</span>
<span class="w">       </span><span class="n">Weiss</span><span class="p">(</span><span class="mi">1</span><span class="p">,:,:,:),</span><span class="n">Weiss</span><span class="p">(</span><span class="mi">2</span><span class="p">,:,:,:)</span><span class="w"> </span><span class="p">)</span>

<span class="w">  </span><span class="c">!&gt; Fit the new bath, starting from the current bath + the update Weiss field</span>
<span class="w">  </span><span class="k">call </span><span class="n">ed_chi2_fitgf</span><span class="p">(</span><span class="n">Weiss</span><span class="p">(</span><span class="mi">1</span><span class="p">,:,:,:),</span><span class="n">Weiss</span><span class="p">(</span><span class="mi">2</span><span class="p">,:,:,:),</span><span class="n">bath</span><span class="p">,</span><span class="n">ispin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="w">  </span><span class="c">!&gt; Linear mixing of the bath (this can be done in alternative of mixing Weiss)</span>
<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">iloop</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="n">Bath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wmixing</span><span class="o">*</span><span class="n">Bath</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="mf">1.d0</span><span class="o">-</span><span class="n">wmixing</span><span class="p">)</span><span class="o">*</span><span class="n">Bath_prev</span>
<span class="w">  </span><span class="n">Bath_prev</span><span class="o">=</span><span class="n">Bath</span>

<span class="w">  </span><span class="c">!Check convergence (using DMFT_TOOLS)</span>
<span class="w">  </span><span class="n">converged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">check_convergence</span><span class="p">(</span><span class="n">Weiss</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:),</span><span class="n">dmft_error</span><span class="p">,</span><span class="n">nsuccess</span><span class="p">,</span><span class="n">nloop</span><span class="p">)</span>
<span class="k">enddo</span>
</pre></div>
</div>
<p>Finally, once converged DMFT solution has been obtained we can get
real-axis Green’s functions using the retrieved normal and anomalous self-energies:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!&gt; retrieve real-axis self-energies (n, a) and build local Green&#39;s function</span>
<span class="k">call </span><span class="n">ed_get_sigma</span><span class="p">(</span><span class="n">Sreal</span><span class="p">(</span><span class="mi">1</span><span class="p">,:,:,:),</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">ed_get_sigma</span><span class="p">(</span><span class="n">Sreal</span><span class="p">(</span><span class="mi">2</span><span class="p">,:,:,:),</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="k">type</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">get_gloc</span><span class="p">(</span><span class="n">Edos</span><span class="p">,</span><span class="n">Ddos</span><span class="p">,</span><span class="n">H0</span><span class="p">,</span><span class="n">Greal</span><span class="p">,</span><span class="n">Sreal</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
<hr><p>We present some results obtained using this <cite>EDIpack2.0</cite> based
program. To begin with, we show in panel A a snapshot of the evolution
of the spectral functions <span class="math notranslate nohighlight">\(-\Im G(\omega)/\pi\)</span> upon increasing
the attraction strength <span class="math notranslate nohighlight">\(U\)</span>. The tiny gap visible for small
attractions (BCS regime) evolves into a large one, separating two high
energy features in the BEC regime.</p>
<a class="with-border reference internal image-reference" href="../_images/02_ahm_fig1.svg"><img alt="../_images/02_ahm_fig1.svg" class="with-border" src="../_images/02_ahm_fig1.svg" style="width: 800px;" />
</a>
<p>In panel B we report the evolution of the pair amplitude <span class="math notranslate nohighlight">\(\phi=
\langle c_{\uparrow}c_{\downarrow}\rangle\)</span> as a function
<span class="math notranslate nohighlight">\(U\)</span>. For comparison, we also show the mean-field results (red solid line).
In both cases the exponential activation of the order parameter is
numerically harder to reproduce. The local quantum fluctuations in
DMFT slightly reduce the value of <span class="math notranslate nohighlight">\(\phi\)</span> compared to
mean-field solution.</p>
<p>In the remaining two panels C and D we analyze the temperature
behavior of superconducting solution at the edge of the BCS regime,
<span class="math notranslate nohighlight">\(U=0.5\)</span>. This  also illustrates the
capability of  <cite>EDIpack2.0</cite>  to obtain finite temperature results.
In C we report the fall off of the pair amplitude as a function of
temperature, while in panel D we show the corresponding potential
energy behavior.</p>
<hr><p>The program to solve the main model is available here:
<a class="reference download internal" download="" href="../_downloads/b59fa1c4d3bd7d9e8f01403cd779c4e7/02_ahm.f90"><code class="xref download docutils literal notranslate"><span class="pre">Attractive</span> <span class="pre">Hubbard</span> <span class="pre">Code</span></code></a></p>
<p>Here is a list of bath files:</p>
<blockquote>
<div><ul class="simple">
<li><p>Bath  <span class="math notranslate nohighlight">\(U=-0.5\)</span>:   <a class="reference download internal" download="" href="../_downloads/1e8d5978b1e2fdf8b2c60a514950bda9/U0.5_hamiltonian.restart"><code class="xref download docutils literal notranslate"><span class="pre">hamiltonian.restart</span></code></a></p></li>
<li><p>Bath  <span class="math notranslate nohighlight">\(U=-1.0\)</span>:   <a class="reference download internal" download="" href="../_downloads/d9e08050c0e87795d14e05aefd1d6771/U1.0_hamiltonian.restart"><code class="xref download docutils literal notranslate"><span class="pre">hamiltonian.restart</span></code></a></p></li>
<li><p>Bath  <span class="math notranslate nohighlight">\(U=-2.0\)</span>:   <a class="reference download internal" download="" href="../_downloads/5c9bcba0bf4a38222327d749b91d68d3/U2.0_hamiltonian.restart"><code class="xref download docutils literal notranslate"><span class="pre">hamiltonian.restart</span></code></a></p></li>
<li><p>Bath  <span class="math notranslate nohighlight">\(U=-5.0\)</span>:   <a class="reference download internal" download="" href="../_downloads/e6e359f063d7c1b4a76b57ffeb71da45/U5.0_hamiltonian.restart"><code class="xref download docutils literal notranslate"><span class="pre">hamiltonian.restart</span></code></a></p></li>
</ul>
</div></blockquote>
<p>An example of the input file used in the calculations can be find here:  <a class="reference download internal" download="" href="../_downloads/49df6e50affaf06b03f90c874b319234/inputAHM.conf"><code class="xref download docutils literal notranslate"><span class="pre">InputFile</span></code></a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="01_bhz.html" class="btn btn-neutral float-left" title="Interacting Bernevig-Hughes-Zhang model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="03_excBHZ.html" class="btn btn-neutral float-right" title="In-plane excitons in quantum spin Hall insulators" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Lorenzo Crippa and Adriano Amaricci.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>